document.addEventListener("DOMContentLoaded",(()=>{if(void 0===window.wppoAdminBar)return;const{apiUrl:e,nonce:r,pageId:t,pagePath:a,i18n:o}=window.wppoAdminBar;function c(e,r="success"){const t="wppo-admin-bar-notice";let a=document.getElementById(t);a||(a=document.createElement("div"),a.id=t,a.style.position="fixed",a.style.top="40px",a.style.right="20px",a.style.padding="10px 15px",a.style.borderRadius="4px",a.style.zIndex="99999",a.style.boxShadow="0 2px 10px rgba(0,0,0,0.2)",a.style.opacity="0",a.style.transition="opacity 0.3s ease-in-out",document.body.appendChild(a)),a.textContent=e,a.className=`wppo-admin-bar-notice--${r}`,"success"===r?(a.style.backgroundColor="#d4edda",a.style.color="#155724",a.style.borderColor="#c3e6cb"):"error"===r?(a.style.backgroundColor="#f8d7da",a.style.color="#721c24",a.style.borderColor="#f5c6cb"):(a.style.backgroundColor="#fff3cd",a.style.color="#856404",a.style.borderColor="#ffeeba"),a.style.border="1px solid",setTimeout((()=>{a.style.opacity="1"}),10),setTimeout((()=>{a.style.opacity="0",setTimeout((()=>{a.parentNode&&a.parentNode.removeChild(a)}),300)}),4e3)}const n=document.querySelector("#wp-admin-bar-wppo_clear_all_cache .ab-item");n&&n.addEventListener("click",(async t=>{if(t.preventDefault(),!window.confirm(o.confirmClearAll||"Are you sure you want to clear ALL cache?"))return;const a=t.target.innerHTML;t.target.innerHTML=o.clearingCache||"Clearing...",t.target.style.pointerEvents="none";try{const t=await fetch(`${e}/clear-cache`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":r},body:JSON.stringify({action:"all"})}),a=await t.json();a.success?c(a.data?.message||o.cacheCleared||"All cache cleared successfully.","success"):(c(a.message||o.cacheClearError||"Error clearing cache.","error"),console.error("Clear All Cache Error:",a))}catch(e){c(o.cacheClearError||"An unexpected error occurred.","error"),console.error("Clear All Cache Exception:",e)}finally{t.target.innerHTML=a,t.target.style.pointerEvents="auto"}}));const s=document.querySelector("#wp-admin-bar-wppo_clear_this_page_cache .ab-item");s&&s.addEventListener("click",(async n=>{if(n.preventDefault(),!a&&!t)return void c(o.cannotClearNonSpecificPage||"Cannot determine the current page to clear cache.","warning");if(!window.confirm(o.confirmClearPage||"Are you sure you want to clear the cache for this page?"))return;const s=n.target.innerHTML;n.target.innerHTML=o.clearingCache||"Clearing...",n.target.style.pointerEvents="none";try{const t=await fetch(`${e}clear-cache`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":r},body:JSON.stringify({action:"page",path:a})}),n=await t.json();n.success?c(n.data?.message||o.cacheCleared||"Cache for this page cleared successfully.","success"):(c(n.message||o.cacheClearError||"Error clearing cache for this page.","error"),console.error("Clear This Page Cache Error:",n))}catch(e){c(o.cacheClearError||"An unexpected error occurred.","error"),console.error("Clear This Page Cache Exception:",e)}finally{n.target.innerHTML=s,n.target.style.pointerEvents="auto"}}))}));